# 画布智能缩放快速使用指南

## 🎯 功能简介

现在可以直接缩放画布上的所有图片元素，无需单独处理PSD文件！

支持两种输出格式：
- **PNG** - 快速，适合最终效果
- **PSD** - 保留图层（实验性）

## 🚀 快速开始

### 步骤1：准备画布
在Excalidraw画布上添加一些图片：
- 可以是上传的图片
- 可以是从PSD提取的图层
- 可以混合使用

### 步骤2：打开智能缩放对话框
点击画布工具栏的 **"智能缩放"** 按钮

### 步骤3：选择"缩放整个画布"
在对话框顶部，选择 **"缩放整个画布"** 按钮

### 步骤4：选择输出格式
- **PNG（图片）** - 推荐，快速且稳定
- **PSD（分层）** - 实验性功能

### 步骤5：设置目标尺寸
输入你想要的宽度和高度（例如：1920 × 1080）

### 步骤6：配置API密钥（可选）
- 如果已在环境变量中配置，可跳过
- 否则输入你的Gemini API密钥

### 步骤7：开始缩放
点击 **"缩放整个画布"** 按钮

### 步骤8：等待完成
- 进度条会显示处理状态
- 通常需要1-2分钟
- 完成后会自动展示到画布

## 💡 使用技巧

### 1. 选择合适的输出格式
```
PNG格式：
✅ 速度快
✅ 文件小
✅ 兼容性好
❌ 不保留图层

PSD格式：
✅ 保留图层结构
❌ 处理稍慢
⚠️ 实验性功能
```

### 2. 优化图层数量
- 建议：5-15个图层
- 可接受：最多20个图层
- 过多图层会增加处理时间

### 3. 合理设置尺寸
```
推荐尺寸：
- 社交媒体：1080 × 1080
- 桌面壁纸：1920 × 1080
- 手机壁纸：1080 × 1920
- 4K显示：3840 × 2160
```

### 4. API配额管理
- 每次缩放会消耗一定API配额
- 建议在测试时使用较小尺寸
- 正式使用时再放大尺寸

## ⚠️ 常见问题

### Q1: 缩放后图片模糊？
**A**: 尝试以下方法：
- 增加目标尺寸
- 确保原始图片质量足够
- 使用PNG格式输出

### Q2: 处理时间太长？
**A**: 可能原因：
- 图层数量过多（减少到15个以内）
- 图片尺寸过大（压缩原图）
- Gemini API响应慢（稍后重试）

### Q3: 提示"画布上没有图片元素"？
**A**: 检查：
- 画布上是否有图片（不是形状）
- 图片是否被删除
- 刷新页面重试

### Q4: API调用失败？
**A**: 检查：
- Gemini API密钥是否正确
- 是否有足够的配额
- 网络连接是否正常
- 参考 `快速修复智能缩放.md`

## 🎨 实际案例

### 案例1：制作社交媒体图片
```
原始画布：
- 5个图层
- 尺寸：800 × 600

目标：
- Instagram帖子：1080 × 1080

操作：
1. 选择"缩放整个画布"
2. 选择"PNG（图片）"
3. 设置尺寸：1080 × 1080
4. 点击"缩放整个画布"
5. 等待1分钟
6. 自动展示到画布
7. 下载使用
```

### 案例2：制作桌面壁纸
```
原始画布：
- 10个图层
- 尺寸：1024 × 768

目标：
- 1920 × 1080壁纸

操作：
1. 选择"缩放整个画布"
2. 选择"PSD（分层）"（可选）
3. 设置尺寸：1920 × 1080
4. 点击"缩放整个画布"
5. 等待2分钟
6. 自动展示到画布
7. 根据需要调整
```

## 📊 性能参考

| 图层数 | 平均尺寸 | 目标尺寸 | 预计时间 |
|--------|----------|----------|----------|
| 5      | 500×500  | 1080×1080| 60秒     |
| 10     | 500×500  | 1920×1080| 90秒     |
| 15     | 800×600  | 2560×1440| 120秒    |
| 20     | 800×600  | 3840×2160| 150秒    |

*注：实际时间取决于网络速度和Gemini API响应速度*

## 🔧 故障排查

### 错误：无法连接到后端服务器
```bash
# 检查后端是否运行
curl http://127.0.0.1:58000/api/canvas/health

# 应返回：
# {"status":"healthy","service":"Canvas Resize Service"}
```

### 错误：Gemini API配额不足
参考：`如何解决配额问题.md`

### 错误：处理超时
- 减少图层数量
- 降低目标尺寸
- 检查网络连接
- 稍后重试

## 📞 获取帮助

### 文档资源
- `画布智能缩放功能实现总结.md` - 完整技术文档
- `快速修复智能缩放.md` - 问题排查
- `如何解决配额问题.md` - API配额问题

### 日志查看
后端日志会显示详细处理信息，帮助诊断问题

### 反馈渠道
如有问题或建议，请提供：
1. 错误截图
2. 浏览器控制台日志
3. 后端日志（如有权限）
4. 复现步骤

---

**提示**：首次使用建议从小尺寸、少图层开始测试，熟悉流程后再处理复杂画布。

**版本**：v2.0 (2025-10-28)




