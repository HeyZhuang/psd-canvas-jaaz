<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas è°ƒè¯•é¡µé¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
        }

        .test-box {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }

        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }

        button:hover {
            background: #0056b3;
        }

        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            max-height: 400px;
        }

        #dom-tree {
            font-size: 12px;
            line-height: 1.4;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ” Canvas é¡µé¢è°ƒè¯•å·¥å…·</h1>

        <div class="test-box">
            <h2>1. æ‰“å¼€ Canvas é¡µé¢</h2>
            <button onclick="openCanvas()">æ‰“å¼€ /canvas/default</button>
            <button onclick="openCanvasNewTab()">åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€</button>
        </div>

        <div class="test-box">
            <h2>2. æ£€æŸ¥é¡µé¢çŠ¶æ€</h2>
            <p><strong>å½“å‰é¡µé¢ï¼š</strong><span id="current-url">-</span></p>
            <p><strong>Bodyå†…å®¹ï¼š</strong><span id="body-check">-</span></p>
            <p><strong>Rootå…ƒç´ ï¼š</strong><span id="root-check">-</span></p>
            <button onclick="checkPage()">æ£€æŸ¥å½“å‰é¡µé¢</button>
        </div>

        <div class="test-box">
            <h2>3. DOM ç»“æ„æ£€æŸ¥</h2>
            <button onclick="inspectDOM()">æ£€æŸ¥ DOM ç»“æ„</button>
            <button onclick="checkStyles()">æ£€æŸ¥æ ·å¼åŠ è½½</button>
            <div id="dom-result"></div>
        </div>

        <div class="test-box">
            <h2>4. Console æ—¥å¿—</h2>
            <button onclick="window.open('/canvas/default', '_blank')">
                æ‰“å¼€Canvaså¹¶æŸ¥çœ‹æ§åˆ¶å°
            </button>
            <p style="margin-top: 10px; color: #666;">
                æç¤ºï¼šæ‰“å¼€åæŒ‰ F12 æŸ¥çœ‹æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
            </p>
        </div>

        <div class="test-box">
            <h2>5. æ‰‹åŠ¨æµ‹è¯•</h2>
            <p>åœ¨æµè§ˆå™¨æ§åˆ¶å°æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š</p>
            <pre id="manual-test">
// æ£€æŸ¥ React Root
console.log('Root element:', document.getElementById('root'));
console.log('Root children:', document.getElementById('root')?.children);

// æ£€æŸ¥ body
console.log('Body children:', document.body.children);

// æ£€æŸ¥æ ·å¼
console.log('Stylesheets:', document.styleSheets.length);

// æ£€æŸ¥é”™è¯¯
console.log('Errors:', window.lastError);
            </pre>
            <button onclick="copyToClipboard()">å¤åˆ¶åˆ°å‰ªè´´æ¿</button>
        </div>
    </div>

    <script>
        function openCanvas() {
            window.location.href = '/canvas/default';
        }

        function openCanvasNewTab() {
            window.open('/canvas/default', '_blank');
        }

        function checkPage() {
            document.getElementById('current-url').textContent = window.location.href;

            const body = document.body;
            const bodyChildren = body.children.length;
            document.getElementById('body-check').textContent =
                `${bodyChildren} ä¸ªå­å…ƒç´  ${bodyChildren === 0 ? 'âŒ' : 'âœ…'}`;

            const root = document.getElementById('root');
            if (root) {
                const rootChildren = root.children.length;
                document.getElementById('root-check').textContent =
                    `å­˜åœ¨ï¼Œ${rootChildren} ä¸ªå­å…ƒç´  ${rootChildren === 0 ? 'âŒ ç©º' : 'âœ…'}`;
            } else {
                document.getElementById('root-check').textContent = 'âŒ ä¸å­˜åœ¨ï¼';
            }
        }

        function inspectDOM() {
            const root = document.getElementById('root');
            const resultDiv = document.getElementById('dom-result');

            if (!root) {
                resultDiv.innerHTML = `<pre class="error">âŒ æ‰¾ä¸åˆ° #root å…ƒç´ ï¼</pre>`;
                return;
            }

            function getDOMTree(element, depth = 0) {
                let result = '  '.repeat(depth) + `<${element.tagName.toLowerCase()}`;

                if (element.id) result += ` id="${element.id}"`;
                if (element.className) result += ` class="${element.className}"`;

                const style = window.getComputedStyle(element);
                const display = style.display;
                const visibility = style.visibility;
                const opacity = style.opacity;

                if (display === 'none') result += ' [display:none]';
                if (visibility === 'hidden') result += ' [visibility:hidden]';
                if (opacity === '0') result += ' [opacity:0]';

                result += '>\n';

                if (depth < 5) {  // é™åˆ¶æ·±åº¦
                    Array.from(element.children).forEach(child => {
                        result += getDOMTree(child, depth + 1);
                    });
                }

                return result;
            }

            const tree = getDOMTree(root);
            resultDiv.innerHTML = `<pre id="dom-tree">${tree}</pre>`;
        }

        function checkStyles() {
            const resultDiv = document.getElementById('dom-result');
            let html = '<h3>æ ·å¼æ£€æŸ¥ç»“æœï¼š</h3><ul>';

            html += `<li>æ ·å¼è¡¨æ•°é‡: ${document.styleSheets.length}</li>`;

            const root = document.getElementById('root');
            if (root) {
                const style = window.getComputedStyle(root);
                html += `<li>Root display: ${style.display}</li>`;
                html += `<li>Root width: ${style.width}</li>`;
                html += `<li>Root height: ${style.height}</li>`;
            }

            const body = document.body;
            const bodyStyle = window.getComputedStyle(body);
            html += `<li>Body display: ${bodyStyle.display}</li>`;
            html += `<li>Body overflow: ${bodyStyle.overflow}</li>`;

            html += '</ul>';
            resultDiv.innerHTML = html;
        }

        function copyToClipboard() {
            const text = document.getElementById('manual-test').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            });
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', () => {
            setTimeout(checkPage, 500);
        });
    </script>
</body>

</html>



