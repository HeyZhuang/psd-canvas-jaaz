# ✅ 快速检查清单

## 🔍 确认 API Key 所属项目（最重要！）

### 步骤 1：查看 API Key 信息

访问：**https://aistudio.google.com/app/apikey**

在页面中找到您的 API Key，旁边会显示所属的项目名称。

### 步骤 2：确认项目

- [ ] API Key 显示的项目是：`__________`
- [ ] 这个项目是否是 `pi3resize`？
  - [ ] ✅ 是 → 跳到"等待配额恢复"
  - [ ] ❌ 否 → 需要重新生成 Key

---

## 🔑 如果需要重新生成 API Key

### 在正确的项目中创建新 Key：

1. 访问：https://aistudio.google.com/
2. 确保右上角显示 `pi3resize` 项目
3. 点击左侧 "API keys"
4. 点击 "Create API Key"
5. 选择 "Create API Key in new project" 或选择 `pi3resize`
6. 复制新的 Key

### 更新配置：

```bash
cd /home/ubuntu/ckz/psd-canvas-jaaz
nano config.env
# 替换 GEMINI_API_KEY= 后面的值

# 或者运行配置脚本
python3 setup_api_key.py
```

### 测试新 Key：

```bash
python3 test_gemini_connection.py
```

---

## ⏰ 如果 Key 正确但配额用尽

### 检查配额类型：

错误消息说明：
```
"You exceeded your current quota, please check your plan and billing details"
```

这通常意味着：
- **每天配额用尽**（1,500 次/天）
- **需要启用计费**

### 解决方案 A：等待（免费用户）

**配额重置时间：**
- UTC 时间：每天 00:00
- 北京时间：每天 08:00

**当前时间和下次重置：**
```bash
# 查看当前 UTC 时间
date -u

# 查看当前北京时间
date
```

### 解决方案 B：启用计费（推荐）

1. 访问：https://console.cloud.google.com/billing
2. 选择 `pi3resize` 项目
3. 绑定信用卡
4. 启用计费

**优势：**
- 立即可用
- 更高配额
- 稳定服务

---

## 📊 查看使用数据

### 方法 1：在正确的项目中查看

1. 访问：https://console.cloud.google.com/projectselector2
2. 选择 API Key 所属的项目（可能不是 pi3resize）
3. 进入：APIs & Services → Dashboard
4. 查找：Generative Language API
5. 点击查看详细使用情况

### 方法 2：等待数据同步

- ⏰ 数据可能延迟 15-60 分钟
- 🔄 强制刷新浏览器（Ctrl+Shift+R）
- 📅 尝试切换时间范围（Last 24 Hours）

---

## 🧪 测试命令

```bash
# 检查配置状态
python3 检查配额状态.py

# 验证 API Key（会显示可用模型）
python3 verify_api_key.py

# 测试实际 API 调用
python3 test_gemini_connection.py

# 重新配置 Key
python3 setup_api_key.py
```

---

## ✅ 成功标志

当一切正常时，您会看到：

```bash
$ python3 test_gemini_connection.py

============================================================
🧪 测试 Gemini API 连接
============================================================

1️⃣ 初始化服务...
✅ 服务初始化成功

2️⃣ 创建测试图像...
✅ 测试图像创建成功

3️⃣ 调用 Gemini API...
⏳ 请稍候，这可能需要几秒钟...

✅ API 调用成功！
📝 响应内容: 这是一张红色的图片...

============================================================
🎉 测试通过！Gemini API 工作正常
============================================================
```

---

## 🚨 常见错误

### 错误 1：429 RESOURCE_EXHAUSTED

**原因**：配额用尽
**解决**：等待重置或启用计费

### 错误 2：403 Forbidden

**原因**：API Key 无效或权限不足
**解决**：重新生成 API Key

### 错误 3：No Usage Data Available

**原因**：查看了错误的项目或数据未同步
**解决**：检查 API Key 所属项目

---

## 💡 最重要的一步

**立即执行：**

访问 https://aistudio.google.com/app/apikey

检查您的 API Key：`AIzaSyBi***************`

确认它属于哪个项目！

这是解决"No Usage Data Available"问题的关键！

---

需要帮助？查看详细文档：`如何解决配额问题.md`
